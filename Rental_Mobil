'''
Nama : Rizky Kurnia Antasari       2357051011
       Ilham Kurniawan
       Muhammad Alvin              2317051040
'''

class Mobil:
    def __init__(self, id_mobil, merk, model, tahun, harga_sewa, tersedia=True):
        self.id_mobil = id_mobil
        self.merk = merk
        self.model = model
        self.tahun = tahun
        self.harga_sewa = harga_sewa
        self.tersedia = tersedia

    def __repr__(self):
        status = "Tersedia" if self.tersedia else "Disewa"
        return f"{self.id_mobil}: {self.merk} {self.model} ({self.tahun}) - {self.harga_sewa}/hari [{status}]"

class Penyewaan:
    def __init__(self, id_sewa, id_mobil, nama_penyewa, tanggal_sewa):
        self.id_sewa = id_sewa
        self.id_mobil = id_mobil
        self.nama_penyewa = nama_penyewa
        self.tanggal_sewa = tanggal_sewa

    def __repr__(self):
        return f"ID Sewa: {self.id_sewa}, ID Mobil: {self.id_mobil}, Nama Penyewa: {self.nama_penyewa}, Tanggal Sewa: {self.tanggal_sewa}"

class SistemRental:
    def __init__(self):
        self.daftar_mobil = []
        self.daftar_sewa = []

    def tambah_mobil(self, mobil):
        self.daftar_mobil.append(mobil)

    def lihat_mobil(self):
        for mobil in self.daftar_mobil:
            print(mobil)

    def update_mobil(self, id_mobil, merk=None, model=None, tahun=None, harga_sewa=None):
        for mobil in self.daftar_mobil:
            if mobil.id_mobil == id_mobil:
                if merk:
                    mobil.merk = merk
                if model:
                    mobil.model = model
                if tahun:
                    mobil.tahun = tahun
                if harga_sewa:
                    mobil.harga_sewa = harga_sewa
                return mobil
        return None

    def hapus_mobil(self, id_mobil):
        self.daftar_mobil = [mobil for mobil in self.daftar_mobil if mobil.id_mobil != id_mobil]

    def bubble_sort_by_harga(self):
        n = len(self.daftar_mobil)
        for i in range(n):
            for j in range(0, n-i-1):
                if self.daftar_mobil[j].harga_sewa > self.daftar_mobil[j+1].harga_sewa:
                    self.daftar_mobil[j], self.daftar_mobil[j+1] = self.daftar_mobil[j+1], self.daftar_mobil[j]

    def binary_search_by_id(self, id_mobil):
        self.daftar_mobil.sort(key=lambda x: x.id_mobil)  # Pastikan daftar sudah terurut
        low, high = 0, len(self.daftar_mobil) - 1
        while low <= high:
            mid = (low + high) // 2
            if self.daftar_mobil[mid].id_mobil == id_mobil:
                return self.daftar_mobil[mid]
            elif self.daftar_mobil[mid].id_mobil < id_mobil:
                low = mid + 1
            else:
                high = mid - 1
        return None

    def sewa_mobil(self, id_sewa, id_mobil, nama_penyewa, tanggal_sewa):
        mobil = self.binary_search_by_id(id_mobil)
        if mobil and mobil.tersedia:
            mobil.tersedia = False
            sewa = Penyewaan(id_sewa, id_mobil, nama_penyewa, tanggal_sewa)
            self.daftar_sewa.append(sewa)
            return sewa
        return None

    def lihat_penyewaan(self):
        for sewa in self.daftar_sewa:
            print(sewa)

def tampilkan_menu():
    print("\n=== Sistem Rental Mobil ===")
    print("1. Tambah Mobil")
    print("2. Lihat Daftar Mobil")
    print("3. Update Mobil")
    print("4. Hapus Mobil")
    print("5. Sortir Mobil berdasarkan Harga Sewa")
    print("6. Cari Mobil berdasarkan ID")
    print("7. Sewa Mobil")
    print("8. Lihat Daftar Penyewaan")
    print("0. Keluar")
    print("===========================")

def main():
    sistem_rental = SistemRental()

    while True:
        tampilkan_menu()
        pilihan = input("Pilih opsi: ")

        if pilihan == '1':
            id_mobil = int(input("Masukkan ID Mobil: "))
            merk = input("Masukkan Merk Mobil: ")
            model = input("Masukkan Model Mobil: ")
            tahun = int(input("Masukkan Tahun Mobil: "))
            harga_sewa = int(input("Masukkan Harga Sewa Mobil per Hari: "))
            mobil = Mobil(id_mobil, merk, model, tahun, harga_sewa)
            sistem_rental.tambah_mobil(mobil)
            print("Mobil berhasil ditambahkan!")
